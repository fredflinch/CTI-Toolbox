function install_sysmon ($opath){
    $sysmon_url = "https://download.sysinternals.com/files/Sysmon.zip"
    $sos_url = "https://github.com/SwiftOnSecurity/sysmon-config/archive/refs/heads/master.zip"
    $wc = New-Object System.Net.WebClient
    $wc.DownloadFile($sysmon_url, "$opath\Sysmon.zip")
    $wc.DownloadFile($sos_url, "$opath\master.zip")
    Expand-Archive "$opath\Sysmon.zip" -DestinationPath "$opath\Sysmon"
    Expand-Archive "$opath\master.zip" -DestinationPath "$opath\master"
    "$opath\Sysmon\sysmon64.exe -accepteula -i $opath\master\sysmon-config-master\sysmonconfig-export.xml" | Invoke-Expression
}

function add_lowprivuser($uname, $pass){
    $p = ConvertTo-SecureString $pass -AsPlainText -Force
    New-LocalUser $uname -Password $p -FullName "Sing MalWardean" -AccountNeverExpires -PasswordNeverExpires
    Add-LocalGroupMember -Group "Remote Desktop Users" -Member $uname
}